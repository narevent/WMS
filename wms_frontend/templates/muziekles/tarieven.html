{% extends 'main/base.html' %}

{% block title %}Tarieven - Wereldmuziekschool{% endblock %}
{% block content %}
<!-- Pricing Information -->
<section class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {% if lestypes %}
            <!-- Filter Section -->
            <div class="mb-12">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <!-- Lesson Type Filter -->
                    <div class="mb-6">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-center mb-4">
                            
                            <div class="flex flex-wrap gap-2">
                                <button 
                                    onclick="filterByType('all')" 
                                    class="type-filter-btn active bg-primary-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-300 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    data-type="all">
                                    Alle lessen
                                </button>
                                <button 
                                    onclick="filterByType('IND')" 
                                    class="type-filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    data-type="IND">
                                    Individueel
                                </button>
                                <button 
                                    onclick="filterByType('DUO')" 
                                    class="type-filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    data-type="DUO">
                                    Duo
                                </button>
                                <button 
                                    onclick="filterByType('TRIO')" 
                                    class="type-filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    data-type="TRIO">
                                    Trio
                                </button>
                                <button 
                                    onclick="filterByType('GROEP')" 
                                    class="type-filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    data-type="GROEP">
                                    Groep
                                </button>
                                <button 
                                    onclick="filterByType('BAND')" 
                                    class="type-filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    data-type="BAND">
                                    Band
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Number of Lessons Filter -->
                    <div class="mb-4 border-t border-gray-200 pt-4">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-center mb-4">
                            <div class="flex flex-wrap gap-2">
                                <button 
                                    onclick="filterByNumber('all')" 
                                    class="number-filter-btn active bg-secondary-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-300 hover:bg-secondary-700 focus:outline-none focus:ring-2 focus:ring-secondary-500"
                                    data-number="all">
                                    Alle aantallen
                                </button>
                                {% for aantal in unique_aantallen %}
                                <button 
                                    onclick="filterByNumber('{{ aantal }}')" 
                                    class="number-filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300 px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-secondary-500"
                                    data-number="{{ aantal }}">
                                    {{ aantal }} lessen
                                </button>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Clear Filters & Results Count -->
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between">
                        <div class="text-sm text-gray-600 mb-2 sm:mb-0">
                            <span id="lesson-count">{{ lestypes|length }}</span> lessen gevonden
                        </div>
                        <button 
                            onclick="clearAllFilters()" 
                            class="text-sm text-primary-600 hover:text-primary-800 font-medium transition-colors">
                            <i class="fas fa-times mr-1"></i>
                            Wis alle filters
                        </button>
                    </div>
                </div>
            </div>

            <!-- Lesson Types List -->
            <div id="lessons-list" class="max-w-5xl mx-auto mb-16">
                <ul class="divide-y divide-gray-200 bg-white rounded-lg shadow">
                    {% for lestype in lestypes %}
                        <li class="lesson-card flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6 px-6 py-4 hover:bg-gray-50 transition"
                            data-soort="{{ lestype.soort }}" data-aantal="{{ lestype.aantal }}">
                            
                            <!-- Left: Lesson Info -->
                            <div class="flex-1">
                                <div class="flex items-center gap-3 mb-2">
                                    <div class="w-10 h-10 bg-gradient-to-br from-primary-100 to-secondary-100 rounded-full flex items-center justify-center">
                                        {% if lestype.soort == 'IND' %}
                                            <i class="fas fa-user text-primary-600"></i>
                                        {% elif lestype.soort == 'DUO' %}
                                            <i class="fas fa-user-friends text-primary-600"></i>
                                        {% elif lestype.soort == 'TRIO' %}
                                            <i class="fas fa-users text-primary-600"></i>
                                        {% elif lestype.soort == 'GROEP' %}
                                            <i class="fas fa-users text-primary-600"></i>
                                        {% elif lestype.soort == 'BAND' %}
                                            <i class="fas fa-music text-primary-600"></i>
                                        {% else %}
                                            <i class="fas fa-music text-primary-600"></i>
                                        {% endif %}
                                    </div>
                                    <h3 class="text-lg font-semibold text-gray-900">{{ lestype.naam }}</h3>
                                </div>

                                <div class="flex flex-wrap gap-4 text-sm text-gray-600">
                                    <span><i class="fas fa-clock mr-1"></i>{{ lestype.duur }} min</span>
                                    <span><i class="fas fa-calendar mr-1"></i>{{ lestype.aantal }} lessen</span>
                                    <span class="inline-block bg-primary-100 text-primary-800 text-xs font-semibold px-2 py-0.5 rounded-full">
                                        {% if lestype.soort == 'IND' %}Individueel
                                        {% elif lestype.soort == 'DUO' %}Duo
                                        {% elif lestype.soort == 'TRIO' %}Trio
                                        {% elif lestype.soort == 'GROEP' %}Groep
                                        {% elif lestype.soort == 'BAND' %}Band
                                        {% else %}{{ lestype.soort }}
                                        {% endif %}
                                    </span>
                                </div>
                            </div>

                            <!-- Right: Prices -->
                            <div class="flex flex-col text-right">
                                <span class="text-xs text-gray-500">&lt; 21 jaar</span>
                                <span class="text-lg font-bold text-primary-600">€{{ lestype.prijs_ex }}</span>
                                <span class="mt-1 text-xs text-gray-500">&gt; 21 jaar</span>
                                <span class="text-sm font-medium text-gray-700">€{{ lestype.prijs_inc }}</span>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            </div>

            <!-- No results message (hidden by default) -->
            <div id="no-results" class="text-center py-16 hidden">
                <i class="fas fa-search text-6xl text-gray-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Geen lessen gevonden</h3>
                <p class="text-gray-600 mb-6">Er zijn geen lessen gevonden voor het geselecteerde filter.</p>
                <button onclick="filterLessons('all')" class="bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors">
                    Toon alle lessen
                </button>
            </div>
        {% else %}
            <div class="text-center py-16">
                <i class="fas fa-music text-6xl text-gray-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Geen tarieven beschikbaar</h3>
                <p class="text-gray-600 mb-6">Er zijn momenteel geen tarieven beschikbaar.</p>
                <a href="{% url 'main:contact' %}" class="bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors">
                    Neem Contact Op
                </a>
            </div>
        {% endif %}

        {{ voorwaarden|safe }}

        <!-- Additional Information -->
        <div class="bg-white rounded-xl shadow-lg p-8 animate-on-scroll">
            <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">Belangrijke Informatie</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                {% if tarieven_model.regel1 %}
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-3 flex items-center">
                            <i class="fas fa-info-circle mr-2 text-primary-600"></i>
                            Algemene Voorwaarden
                        </h4>
                        <ul class="space-y-2 text-gray-600">
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mr-2 mt-1"></i>
                                <span>{{tarieven_modal.regel1}}</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mr-2 mt-1"></i>
                                <span>{{tarieven_modal.regel2}}</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mr-2 mt-1"></i>
                                <span>{{tarieven_modal.regel3}}</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-green-500 mr-2 mt-1"></i>
                                <span>{{tarieven_modal.regel4}}</span>
                            </li>
                        </ul>
                    </div>
                {% endif %}
                {% if betaling_model.regel1 %}
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-3 flex items-center">
                            <i class="fas fa-credit-card mr-2 text-primary-600"></i>
                            Betaling
                        </h4>
                        <ul class="space-y-2 text-gray-600">
                            <li class="flex items-start">
                                <i class="fas fa-calendar-alt text-blue-500 mr-2 mt-1"></i>
                                <span>{{betaling_modal.regel1}}</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-university text-blue-500 mr-2 mt-1"></i>
                                <span>{{betaling_modal.regel2}}</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-percentage text-blue-500 mr-2 mt-1"></i>
                                <span>{{betaling_modal.regel3}}</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-handshake text-blue-500 mr-2 mt-1"></i>
                                <span>{{betaling_modal.regel4}}</span>
                            </li>
                        </ul>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="bg-primary-600 text-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl font-bold mb-6">Vragen over onze tarieven?</h2>
        <p class="text-xl mb-8 max-w-2xl mx-auto">
            Neem contact met ons op voor meer informatie over onze lesmogelijkheden en prijzen. 
            We helpen je graag bij het maken van de juiste keuze.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="{% url 'main:contact' %}" class="bg-white text-primary-600 hover:bg-gray-100 px-8 py-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
                <i class="fas fa-envelope mr-2"></i>
                Contact Opnemen
            </a>
            <a href="{% url 'muziekles:proefles' %}" class="bg-transparent border-2 border-white text-white hover:bg-white hover:text-primary-600 px-8 py-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
                <i class="fas fa-calendar mr-2"></i>
                Gratis Proefles
            </a>
        </div>
    </div>
</section>

<style>
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .lesson-card {
        transition: all 0.3s ease;
    }

    .lesson-card.hidden {
        display: none;
    }

    .type-filter-btn.active {
        background-color: rgb(79 70 229);
        color: white;
    }

    .type-filter-btn:not(.active) {
        background-color: rgb(229 231 235);
        color: rgb(55 65 81);
    }

    .number-filter-btn.active {
        background-color: rgb(168 85 247);
        color: white;
    }

    .number-filter-btn:not(.active) {
        background-color: rgb(229 231 235);
        color: rgb(55 65 81);
    }
</style>

<script>
// Filter state
let currentTypeFilter = 'all';
let currentNumberFilter = 'all';

function filterByType(soort) {
    currentTypeFilter = soort;
    updateTypeFilterButtons(soort);
    applyFilters();
}

function filterByNumber(aantal) {
    currentNumberFilter = aantal;
    updateNumberFilterButtons(aantal);
    applyFilters();
}

function clearAllFilters() {
    currentTypeFilter = 'all';
    currentNumberFilter = 'all';
    updateTypeFilterButtons('all');
    updateNumberFilterButtons('all');
    applyFilters();
}

function updateTypeFilterButtons(activeType) {
    const typeButtons = document.querySelectorAll('.type-filter-btn');
    typeButtons.forEach(btn => {
        btn.classList.remove('active');
        btn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
        btn.classList.remove('bg-primary-600', 'text-white');
    });

    const activeButton = document.querySelector(`[data-type="${activeType}"]`);
    if (activeButton) {
        activeButton.classList.add('active');
        activeButton.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
        activeButton.classList.add('bg-primary-600', 'text-white');
    }
}

function updateNumberFilterButtons(activeNumber) {
    const numberButtons = document.querySelectorAll('.number-filter-btn');
    numberButtons.forEach(btn => {
        btn.classList.remove('active');
        btn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
        btn.classList.remove('bg-secondary-600', 'text-white');
    });

    const activeButton = document.querySelector(`[data-number="${activeNumber}"]`);
    if (activeButton) {
        activeButton.classList.add('active');
        activeButton.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
        activeButton.classList.add('bg-secondary-600', 'text-white');
    }
}

function applyFilters() {
    const lessonCards = document.querySelectorAll('.lesson-card');
    const noResults = document.getElementById('no-results');
    const lessonCount = document.getElementById('lesson-count');
    let visibleCount = 0;

    lessonCards.forEach(card => {
        const cardSoort = card.getAttribute('data-soort');
        const cardAantal = parseInt(card.getAttribute('data-aantal'));
        
        const typeMatch = currentTypeFilter === 'all' || cardSoort === currentTypeFilter;
        const numberMatch = currentNumberFilter === 'all' || cardAantal === parseInt(currentNumberFilter);
        
        if (typeMatch && numberMatch) {
            card.style.display = 'block';
            card.classList.remove('hidden');
            visibleCount++;
            
            // Add fade-in animation
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
                card.style.transition = 'all 0.3s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 50);
        } else {
            card.style.display = 'none';
            card.classList.add('hidden');
        }
    });

    // Update count and show/hide no results
    lessonCount.textContent = visibleCount;
    
    if (visibleCount === 0) {
        noResults.classList.remove('hidden');
        document.getElementById('lessons-list').style.display = 'none';
    } else {
        noResults.classList.add('hidden');
        document.getElementById('lessons-list').style.display = 'block';
    }
}

// Backward compatibility - keeping the old function name
function filterLessons(soort) {
    filterByType(soort);
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    // Set the default filters
    currentTypeFilter = 'IND';
    currentNumberFilter = '38';

    // Update the filter buttons and apply the filters immediately.
    updateTypeFilterButtons(currentTypeFilter);
    updateNumberFilterButtons(currentNumberFilter);
    applyFilters();
    
    // Add smooth scrolling when filtering
    const allFilterButtons = document.querySelectorAll('.type-filter-btn, .number-filter-btn');
    allFilterButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            setTimeout(() => {
                document.getElementById('lessons-list').scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }, 100);
        });
    });
});
</script>
{% endblock %}